### 问题：
通过商家的订单，满足条件就可能给一些奖励金，每创建一个订单就去计算一次，这样的话，因为订单太多会增加服务器压力，因此改成，每天跑一个脚本生成昨日的数据，然后当日的数据从订单中实时聚合。这个脚本是每天早晨0-3点之间运行。但是这样就在每天未运行脚本前出现了一个昨日数据不存在的时间窗口。

### 解决办法：
1. 在取数据时，先判断昨日的数据是否生成，如果生成了就直接取，未生成就通过订单聚合。
2. 因为有离线订单的情况，这里最好是每一个订单计算一次，要不然很难保证计算完后，不会再有离线订单过来。
3. 一般软件在显示各种收益类的数据时，在跨天后，都不是实时显示的，一般处理都是数据暂不显示。